const projectsData = [
  {
    id: "Previdengue",
    "data-title": "Previdengue",
    "data-date": "25 de setembro de 2025",
    "data-image": "./Images/Projetos/previdengue.png",
    "data-icon": "iconePrevidengue.png",
    "data-site": "https://previdengue.vercel.app/",
    "data-github": "https://github.com/IonMateus/PreviDengue",
    "data-categories": "Web",
    "data-description": "Previdengue √© uma plataforma web que integra previs√µes semanais de casos de dengue e uma ferramenta de identifica√ß√£o de criadouros a partir de fotos a√©reas. A interface permite consultar previs√µes por munic√≠pio, visualizar mapas de risco, acessar relat√≥rios hist√≥ricos e usar a ferramenta de inspe√ß√£o para marcar e mapear poss√≠veis focos, facilitando a√ß√µes preventivas por cidad√£os e equipes de sa√∫de.",
    h2: "Previdengue (TCC)",
    stacks: [
      "bx bxl-html5",
      "bx bxl-css3",
      "bx bxl-typescript",
      "bx bxl-react",
      "bx bxl-python"
    ]
  },
  {
    id: "CodeDrafts",
    "data-title": "CodeDrafts",
    "data-date": "4 de setembro de 2023",
    "data-image": "./Images/Projetos/CodeDraftsDark.png",
    "data-icon": "CodeDraftsIcon.png",
    "data-site": "https://codedrafts-5as0.onrender.com/",
    "data-github": "https://github.com/ArthurGamaJorge/codedrafts",
    "data-categories": "Web,Java",
    "data-web-image": "./Images/Projetos/CodeDraftsDark.png",
    "data-java-image": "./Images/Projetos/CodeDraftsJava.png",
    "data-web-description": "Uma rede social gamificada e interativa, desenvolvida com integra√ß√£o a um banco de dados robusto, onde os usu√°rios podem criar e gerenciar postagens, interagir com conte√∫dos por meio de curtidas e coment√°rios, realizar buscas avan√ßadas por temas ou usu√°rios, denunciar publica√ß√µes inadequadas, acompanhar perfis, al√©m de visualizar rankings baseados em engajamento. A plataforma tamb√©m permite o envio e exibi√ß√£o de imagens, e conta com um sistema de conquistas desbloque√°veis, incentivando a participa√ß√£o ativa dos usu√°rios por meio de desafios e recompensas.",
    "data-java-description": "O painel administrativo do aplicativo, desenvolvido em Java, oferece uma interface para a modera√ß√£o e gest√£o da plataforma. Nele, √© poss√≠vel visualizar todas as postagens, coment√°rios e usu√°rios denunciados, permitindo que administradores tomem medidas como banir ou desativar contas que violem as diretrizes. Al√©m disso, o sistema permite a cria√ß√£o e gerenciamento de t√≥picos e conquistas, que podem ser atribu√≠dos a usu√°rios para incentivar o engajamento. O painel tamb√©m inclui ferramentas de an√°lise, fornecendo estat√≠sticas sobre a atividade da rede social.",
    h2: "CodeDrafts",
    classes: ["Web", "Software"],
    stacks: [
      "bx bxl-html5",
      "bx bxl-css3",
      "bx bxl-javascript",
      "bx bxl-nodejs",
      { type: "svg", src: "./Images/Habilidades/icons8-sql-server.svg", class: "sql-icon" },
      "bx bxl-google-cloud",
      "bx bxl-java"
    ]
  },
  {
    id: "YourDle",
    "data-title": "YourDle",
    "data-date": "15 de novembro de 2023",
    "data-image": "./Images/Projetos/YourDle.png",
    "data-icon": "YourDleIcon.png",
    "data-site": "https://yourdle-seven.vercel.app/",
    "data-github": "https://github.com/ArthurGamaJorge/YourDle",
    "data-categories": "Web",
    "data-description": "YourDle √© uma plataforma interativa onde voc√™ pode explorar diversos desafios de palavras, como o cl√°ssico Termo (Wordle), onde precisa adivinhar uma palavra ‚Äî ou v√°rias, dependendo do modo ‚Äî e o Conexo, que testa sua habilidade de identificar padr√µes entre quatro palavras. Com uma conta, voc√™ pode criar seus pr√≥prios desafios, compartilhar com a comunidade e interagir avaliando as cria√ß√µes de outros jogadores. O site utiliza um banco de dados hospedado para armazenar todas as informa√ß√µes.",
    h2: "YourDle",
    stacks: [
      "bx bxl-html5",
      "bx bxl-css3",
      "bx bxl-javascript",
      "bx bxl-nodejs",
      { type: "svg", src: "./Images/Habilidades/icons8-sql-server.svg", class: "sql-icon" }
    ]
  },
  {
    id: "IOOON",
    "data-title": "IOOON Airlines",
    "data-date": "13 de maio de 2023",
    "data-image": "./Images/Projetos/FormularioDark.png",
    "data-icon": "IOOON logo.png",
    "data-site": "https://iooonairlines.netlify.app/",
    "data-github": "https://github.com/ArthurGamaJorge/Iooon-Airlines",
    "data-categories": "Web",
    "data-description": "Ap√≥s o login, este site permite que os usu√°rios consultem informa√ß√µes detalhadas sobre voos reais, acessando dados por meio de uma API integrada. A plataforma oferece funcionalidades para visualizar hor√°rios de partidas e chegadas, status dos voos, e outros detalhes relevantes",
    h2: "IOOON Airlines",
    stacks: [
      "bx bxl-html5",
      "bx bxl-css3",
      "bx bxl-javascript",
      "bx bxl-react"
    ]
  },
  {
    id: "HollowKnight",
    "data-title": "Hollow Knight Guia",
    "data-date": "27 de mar√ßo de 2023",
    "data-image": "./Images/Projetos/HollowKnight.png",
    "data-icon": "IconeHollow.png",
    "data-site": "https://arthurgamajorge.github.io/Hollow-Knight-Guia/",
    "data-github": "https://github.com/ArthurGamaJorge/Hollow-Knight-Guia",
    "data-categories": "Web",
    "data-description": "Este site √© um guia completo sobre Hollow Knight, oferecendo informa√ß√µes detalhadas sobre locais, personagens, inimigos, hist√≥ria e muito mais. Foi meu primeiro projeto, desenvolvido para treinar minhas habilidades em HTML, CSS e JavaScript.",
    h2: "Hollow Knight Guia",
    stacks: [
      "bx bxl-html5",
      "bx bxl-css3",
      "bx bxl-javascript"
    ]
  },
  {
    id: "AlzCare",
    "data-title": "AlzCare",
    "data-date": "11 de julho de 2024",
    "data-image": "./Images/Projetos/AlzCare.png",
    "data-categories": "Mobile",
    "data-aia": "./Images/Projetos/AlzCare.aia",
    "data-description": "AlzCare √© um aplicativo inovador desenvolvido para oferecer suporte integral a cuidadores informais de idosos com Alzheimer. Com um conjunto completo de ferramentas e recursos, o AlzCare auxilia os cuidadores na cria√ß√£o de rotinas guiadas, aprendizado cont√≠nuo, suporte r√°pido para desafios di√°rios e monitoramento da sa√∫de do idoso, garantindo mais qualidade de vida tanto para o cuidador quanto para o idoso. Gra√ßas √† sua proposta inovadora e impacto social, o AlzCare foi reconhecido em importantes competi√ß√µes tecnol√≥gicas: üèÜ Melhor projeto do estado de SP pelo Desafio Liga Jovem; ü•â Medalha de Bronze na Olimp√≠ada Brasileira de Tecnologia; ü•â 3¬∫ Lugar no Desafio App da OBT 2024.",
    h2: "AlzCare",
    stacks: [
      "bx bxl-html5",
      "bx bxl-css3",
      "bx bxl-javascript",
      "bx bxl-nodejs",
      "bx bxs-trophy"
    ]
  },
  {
    id: "Aprendize",
    "data-title": "Aprendize",
    "data-date": "14 de novembro de 2024",
    "data-image": "./Images/Projetos/Aprendize.png",
    "data-categories": "Mobile",
    "data-github": "https://github.com/cc23135/aprendize",
    "data-description": "Aprendize √© um aplicativo completo para organiza√ß√£o e otimiza√ß√£o dos estudos. Ele oferece cron√¥metros para focar, tarefas para organizar atividades, revis√µes marc√°veis para refor√ßar o aprendizado e um calend√°rio que registra o hist√≥rico de estudo. Com estat√≠sticas detalhadas e um ranking de tempo e exerc√≠cios, o Aprendize mant√©m os usu√°rios motivados a progredir. Al√©m disso, suas comunidades de estudo permitem a troca de conhecimento entre estudantes por mat√©ria e t√≥pico, criando um ambiente colaborativo. Simples, eficiente e interativo.",
    h2: "Aprendize",
    stacks: [
      "bx bxl-flutter",
      "bx bxl-javascript",
      "bx bxl-nodejs",
      "bx bxl-google-cloud"
    ]
  },
  {
    id: "Monitoria",
    "data-title": "Agendamento de monitoria",
    "data-date": "02 de julho de 2023",
    "data-image": "./Images/Projetos/AgendamentoMonitoria.png",
    "data-categories": "Software",
    "data-github": "https://github.com/ArthurGamaJorge/Agendamento-de-monitoria",
    "data-description": "Programa desenvolvido em Python utilizando Qt Designer para criar uma interface gr√°fica, o sistema permite o gerenciamento de alunos, computadores e hor√°rios, facilitando o processo de agendamento de monitorias na escola Cotuca e garantindo uma gest√£o eficiente.",
    h2: "Agendamento de monitoria",
    stacks: [
      "bx bxl-python"
    ]
  }
];

const skillsData = [
  { id: "html", name: "HTML", category: "HabWeb", icon: "https://raw.githubusercontent.com/devicons/devicon/master/icons/html5/html5-original.svg", alt: "html-icon" },
  { id: "css", name: "CSS", category: "HabWeb", icon: "https://raw.githubusercontent.com/devicons/devicon/master/icons/css3/css3-original.svg", alt: "css-icon" },
  { id: "javascript", name: "Javascript", category: "HabWeb", icon: "./Images/Habilidades/javascript.png", alt: "js-icon" },
  { id: "typescript", name: "Typescript", category: "HabWeb", icon: "./Images/Habilidades/typescript.png", alt: "ts-icon" },
  { id: "nodejs", name: "NodeJS", category: "HabWeb", icon: "./Images/Habilidades/node.png", alt: "node-icon" },
  { id: "react", name: "React", category: "HabWeb", icon: "https://upload.wikimedia.org/wikipedia/commons/thumb/a/a7/React-icon.svg/2300px-React-icon.svg.png", alt: "react-icon" },
  { id: "flutter", name: "Flutter", category: "Mobile", icon: "https://img.icons8.com/fluent/512/flutter.png", alt: "flutter-icon" },
  { id: "dart", name: "Dart", category: "Mobile", icon: "./Images/Habilidades/dart.png", alt: "dart-icon" },
  { id: "kotlin", name: "Kotlin", category: "Mobile", icon: "https://upload.wikimedia.org/wikipedia/commons/thumb/7/74/Kotlin_Icon.png/1024px-Kotlin_Icon.png", alt: "kotlin-icon" },
  { id: "swift", name: "Swift", category: "Mobile", icon: "https://cdn-icons-png.flaticon.com/512/732/732250.png", alt: "swift-icon" },
  { id: "python", name: "Python", category: "Software", icon: "https://raw.githubusercontent.com/devicons/devicon/master/icons/python/python-original.svg", alt: "python-icon" },
  { id: "java", name: "Java", category: "Software", icon: "./Images/Habilidades/Java.png", alt: "java-icon" },
  { id: "springboot", name: "Spring Boot", category: "Software", icon: "https://img.icons8.com/color/600/spring-logo.png", alt: "springBoot-icon" },
  { id: "c", name: "C", category: "Software", icon: "./Images/Habilidades/c.png", alt: "c-icon" },
  { id: "csharp", name: "C#", category: "Software", icon: "./Images/Habilidades/csharp.png", alt: "c#-icon" },
  { id: "dotnet", name: ".NET", category: "Software", icon: "https://img.icons8.com/color/512/net-framework.png", alt: ".net-icon" },
  { id: "cplusplus", name: "C++", category: "Software", icon: "https://cdn-icons-png.flaticon.com/512/6132/6132222.png", alt: "c++-icon" },
  { id: "unity", name: "Unity", category: "Outros", icon: "./Images/Habilidades/unity.png", alt: "unity-icon" },
  { id: "mssql", name: "MSSQL", category: "BancoDeDados", icon: "https://img.icons8.com/color/512/microsoft-sql-server.png", alt: "mssql-icon" },
  { id: "mysql", name: "MySQL", category: "BancoDeDados", icon: "./Images/Habilidades/mysql.png", alt: "MySQL-icon" },
  { id: "firebase", name: "Firebase", category: "BancoDeDados", icon: "https://cdn4.iconfinder.com/data/icons/google-i-o-2016/512/google_firebase-2-512.png", alt: "firebase-icon" },
  { id: "arduino", name: "Arduino", category: "Outros", icon: "https://cdn.iconscout.com/icon/free/png-256/free-arduino-226072.png?f=webp", alt: "arduino-icon" },
  { id: "git", name: "Git", category: "Outros", icon: "https://img.icons8.com/color/512/git.png", alt: "git-icon" }
];

const researchData = [
  {
    id: "AlzCare-OBT",
    title: "AlzCare ‚Äî Bronze & terceiro lugar nacional no Desafio APP da OBT",
    date: "2024",
    image: "https://media.licdn.com/dms/image/v2/D4D22AQHpIL6Wfwv0wA/feedshare-shrink_2048_1536/feedshare-shrink_2048_1536/0/1722387310338?e=1761782400&v=beta&t=FHg60B_cKxlcOBW5AH5JkiPQPCVH1Enf-aHJ98_DbN4",
    category: "Desafios de Tecnologia",
    description: "A equipe ol√≠mpica que fui integrante, The Tech Titans (TTT) ganhou medalha de bronze na OBT, sendo convidada para a Semana da Escola Avan√ßada de Tecnologia (EAT), onde ganhamos em terceiro lugar, em escala nacional, o 'Desafio App' com o projeto AlzCare, um aplicativo para suporte para cuidadores informais de idosos com Alzheimer.",
  },
  {
    id: "Inova-Jovem",
    title: "Representantes do Estado de S√£o Paulo no Liga Jovem",
    date: "2024",
    image: "https://www.inova.unicamp.br/inovajovem/wp-content/uploads/2024/11/Participantes-Final-Inova-Jovem-Reproducao-Zoom-1-1024x478.png",
    category: "Competi√ß√µes de Empreendedorismo",
    description: "O projeto AlzCare venceu como melhor projeto do estado de S√£o Paulo no Desafio Liga Jovem, al√©m disso o projeto tamb√©m foi finalista no Inova Jovem Unicamp.",
  },
    {
    id: "Monitor-Voluntario",
    title: "Monitor Volunt√°rio",
    date: "2025",
    image: "https://media.licdn.com/dms/image/v2/D4D22AQFYdMRYo9r61Q/feedshare-shrink_1280/B4DZbLdFNCG8Ak-/0/1747170121564?e=1761782400&v=beta&t=7BkcpQgZo3m209QbiCk0-xhXSNzz61QAJMiRCXsGPVA",
    category: "Voluntariado",
    description: "Fui monitor no evento Elas-<TIC> e ExpoCotuca, programas de incentivo √† participa√ß√£o feminina e de estudantes de escolas p√∫blicas na √°rea de tecnologia",
  },
];

  const medalsCard = {
    id: "Medalhas",
    title: "Multi Medalhista em Olimp√≠adas Cient√≠ficas",
    date: "2022-2025",
    image: "https://elitecampinas.com.br/wp-content/uploads/2023/11/olimpiadas-site-elite-21.png",
    category: "Conquistas",
    description: "Durante meu percurso acad√™mico, participei de diversas olimp√≠adas cient√≠ficas, conquistando medalhas de Ouro, Prata e Bronze em √°reas como Ci√™ncias, Matem√°tica e Tecnologia. Essas experi√™ncias foram fundamentais para o fortalecimento de minha dedica√ß√£o ao estudo.",
    medals: {
      Ouro: [
        "Ol√≠mpiada Nacional de Ci√™ncias (ONC) - 2024",
        "Competi√ß√£o USP de Conhecimentos e Oportunidades (CUCO) - 2024",
        "Ol√≠mpiada Brasileira de Astronomia e Astron√°utica (OBA) - 2022"
      ],
      Prata: [
        "Ol√≠mpiada Nacional de Ci√™ncias (ONC) - 2023",
        "Competi√ß√£o USP de Conhecimentos e Oportunidades (CUCO) - 2023",
        "Ol√≠mpiada Brasileira de Astronomia e Astron√°utica (OBA) - 2025",
        "Canguru de Matem√°tica - 2025"
      ],
      Bronze: [
        "Ol√≠mpiada Brasileira de Tecnologia (OBT) - 2024",
        "Canguru de Matem√°tica - 2024",
        "Ol√≠mpiada Brasileira de Astronomia e Astron√°utica (OBA) - 2021"
      ]
    }
  };


function formatDate(raw) {
  if (!raw) return "";
  if (/^\d{2}\/\d{2}\/\d{4}$/.test(raw)) return raw;
  if (/^\d{4}-\d{2}-\d{2}/.test(raw)) {
    const d = new Date(raw);
    if (!isNaN(d)) return pad(d.getDate()) + "/" + pad(d.getMonth() + 1) + "/" + d.getFullYear();
  }
  const m = raw.match(/(\d{1,2}).*?([0-9]{4})/);
  if (m) {
    const day = parseInt(m[1], 10);
    const year = parseInt(m[2], 10);
    const months = { janeiro:1, fevereiro:2, mar√ßo:3, marco:3, abril:4, maio:5, junho:6, julho:7, agosto:8, setembro:9, outubro:10, novembro:11, dezembro:12 };
    const lower = raw.toLowerCase();
    for (const name in months) if (lower.includes(name)) return pad(day) + "/" + pad(months[name]) + "/" + year;
    return pad(day) + "/" + year;
  }
  return raw;
}

function pad(n){ return (n < 10 ? "0" : "") + n; }

function renderPortfolio(containerSelector, data) {
  const container = typeof containerSelector === "string" ? document.querySelector(containerSelector) : containerSelector;
  if (!container) return;
  container.innerHTML = "";
  data.forEach(p => {
    const proj = document.createElement("div");
    proj.classList.add("Projeto");
    if (p.classes) {
      if (Array.isArray(p.classes)) p.classes.forEach(c => c && proj.classList.add(c));
      else p.classes.toString().split(/[,\s]+/).forEach(c => c && proj.classList.add(c));
    }
    const categories = (p["data-categories"] || "").toString().split(/[,\s]+/).map(s => s.trim()).filter(Boolean);
    categories.forEach(c => proj.classList.add(c));
    if (p.id) proj.id = p.id;
    Object.keys(p).forEach(key => { if (key.startsWith("data-")) proj.setAttribute(key, p[key]); });
    const h2 = document.createElement("h2");
    h2.textContent = p.h2 ?? p["data-title"] ?? "";
    proj.appendChild(h2);
    const stacksDiv = document.createElement("div");
    stacksDiv.className = "stacks";
    if (Array.isArray(p.stacks)) {
      p.stacks.forEach(s => {
        if (typeof s === "string") {
          const i = document.createElement("i");
          s.split(/\s+/).forEach(cl => cl && i.classList.add(cl));
          stacksDiv.appendChild(i);
        } else if (s && typeof s === "object") {
          if (s.type === "svg" && s.src) {
            const obj = document.createElement("object");
            obj.type = "image/svg+xml";
            obj.data = s.src;
            if (s.class) obj.className = s.class;
            stacksDiv.appendChild(obj);
          } else if (s.tag === "img" && s.src) {
            const img = document.createElement("img");
            img.src = s.src;
            if (s.alt) img.alt = s.alt;
            if (s.class) img.className = s.class;
            stacksDiv.appendChild(img);
          } else {
            const span = document.createElement("span");
            span.textContent = JSON.stringify(s);
            stacksDiv.appendChild(span);
          }
        }
      });
    }
    proj.appendChild(stacksDiv);
    const infoBar = document.createElement("div");
    infoBar.className = "info-bar";
    const dateSpan = document.createElement("span");
    dateSpan.className = "data";
    dateSpan.textContent = formatDate(p["data-date"] || "");
    infoBar.appendChild(dateSpan);
    const btn = document.createElement("button");
    btn.className = "btn-veja-mais";
    btn.type = "button";
    btn.textContent = "Veja mais";
    btn.addEventListener("click", () => { const site = p["data-site"]; if (site) window.open(site, "_blank", "noopener"); });
    infoBar.appendChild(btn);
    proj.appendChild(infoBar);
    const bg = p["data-image"] || p["data-web-image"] || p["data-java-image"] || "";
    proj.style.backgroundImage = bg ? `url('${bg}')` : "";
    container.appendChild(proj);
  });
}

function renderSkills(containerSelector, data) {
  const container = typeof containerSelector === "string" ? document.querySelector(containerSelector) : containerSelector;
  if (!container) return;
  container.innerHTML = "";
  data.forEach(s => {
    const card = document.createElement("div");
    card.classList.add("Cart√£o");
    if (s.category) card.classList.add(s.category);
    if (s.id) card.id = s.id;
    const img = document.createElement("img");
    img.className = "habilidade";
    img.alt = s.alt || s.name || "";
    img.src = s.icon || "";
    card.appendChild(img);
    const p = document.createElement("p");
    p.textContent = s.name || "";
    card.appendChild(p);
    container.appendChild(card);
  });
}

(function () {
  function createResearchCard(item) {
    const article = document.createElement("article");
    article.className = "research-card";
    article.setAttribute("role", "listitem");
    article.tabIndex = 0;
    if (item.id) article.id = item.id;

    const cover = document.createElement("div");
    cover.className = "research-cover";
    if (item.image) {
      const img = document.createElement("img");
      img.loading = "lazy";
      img.decoding = "async";
      img.src = item.image;
      img.alt = item.title || "";
      cover.appendChild(img);
    }
    article.appendChild(cover);

    const body = document.createElement("div");
    body.className = "research-body";

    const cat = document.createElement("p");
    cat.className = "research-category";
    cat.textContent = item.category || "";
    body.appendChild(cat);

    const h = document.createElement(item.title && item.title.length ? "h3" : "h4");
    h.className = "research-title";
    h.textContent = item.title || "";
    body.appendChild(h);

    if (item.description) {
      const desc = document.createElement("p");
      desc.className = "research-description";
      desc.textContent = item.description;
      body.appendChild(desc);
    }

    const meta = document.createElement("div");
    meta.className = "research-meta";
    const dateSpan = document.createElement("span");
    dateSpan.className = "research-period";
    dateSpan.textContent = item.date || "";
    meta.appendChild(dateSpan);
    body.appendChild(meta);

    article.appendChild(body);

    if (item.medals && typeof item.medals === "object") {
      const btn = document.createElement("button");
      btn.type = "button";
      btn.className = "medal-btn";
      btn.id = "openMedalsBtn";
      btn.setAttribute("aria-haspopup", "dialog");
      btn.setAttribute("aria-controls", "medalsModal");
      btn.textContent = "Medalhas";
      article.appendChild(btn);
      btn.addEventListener("click", () => openModal(item.medals, btn));
    }

    return { article, coverImage: cover.querySelector("img") || null };
  }

  function renderResearchGrid(containerSelector, data) {
    const container = typeof containerSelector === "string" ? document.querySelector(containerSelector) : containerSelector;
    if (!container) return;
    container.innerHTML = "";
    const frag = document.createDocumentFragment();
    const imgs = [];

    const dataset = Array.isArray(data) ? data.slice() : [];
    if (!dataset.some(d => d && d.id === "Medalhas")) dataset.push(medalsCard);

    dataset.forEach(item => {
      const { article, coverImage } = createResearchCard(item);
      frag.appendChild(article);
      if (coverImage) imgs.push(coverImage);
    });

    container.appendChild(frag);

    let pending = imgs.length;
    const finish = () => { if (window.sobreMimRecalculate) window.sobreMimRecalculate(); };
    if (!pending) finish();
    else {
      imgs.forEach(i => {
        if (i.complete) { pending--; if (!pending) finish(); }
        else {
          i.addEventListener("load", () => { pending--; if (!pending) finish(); }, { once: true });
          i.addEventListener("error", () => { pending--; if (!pending) finish(); }, { once: true });
        }
      });
    }
  }

  function ensureModal() {
    if (document.getElementById("medalsModalOverlay")) return;
    const overlay = document.createElement("div");
    overlay.id = "medalsModalOverlay";
    overlay.className = "medals-modal-overlay";
    overlay.innerHTML = `
      <div class="medals-modal" role="dialog" aria-modal="true" id="medalsModal" aria-labelledby="medalsTitle">
        <header>
          <div>
            <h3 id="medalsTitle">Medalhas e Conquistas</h3>
            <div class="medals-sub">Detalhamento das medalhas conquistadas</div>
          </div>
          <button class="medals-close" id="medalsCloseBtn" aria-label="Fechar">X</button>
        </header>
        <br><br><br><br>
        <div class="medals-body" id="medalsBody"></div>
        <div class="medals-footer">
          <button class="close-secondary" id="medalsCloseBtn2">Fechar</button>
        </div>
      </div>
    `;
    document.body.appendChild(overlay);
    overlay.addEventListener("click", (e) => { if (e.target === overlay) closeModal(); });
    document.getElementById("medalsCloseBtn").addEventListener("click", closeModal);
    document.getElementById("medalsCloseBtn2").addEventListener("click", closeModal);
    document.addEventListener("keydown", (e) => { if (e.key === "Escape" && overlay.classList.contains("open")) closeModal(); });
  }

  let lastFocused = null;
  let focusTrapHandler = null;

  function trapFocus(modal) {
    lastFocused = document.activeElement;
    const focusable = modal.querySelectorAll('a[href], button:not([disabled]), textarea, input, select, [tabindex]:not([tabindex="-1"])');
    const nodes = Array.from(focusable);
    if (!nodes.length) return;
    const first = nodes[0];
    const last = nodes[nodes.length - 1];
    focusTrapHandler = function (e) {
      if (e.key !== "Tab") return;
      if (e.shiftKey) {
        if (document.activeElement === first) { e.preventDefault(); last.focus(); }
      } else {
        if (document.activeElement === last) { e.preventDefault(); first.focus(); }
      }
    };
    document.addEventListener("keydown", focusTrapHandler);
  }

  function releaseFocusTrap() {
    if (focusTrapHandler) document.removeEventListener("keydown", focusTrapHandler);
    focusTrapHandler = null;
    if (lastFocused && typeof lastFocused.focus === "function") lastFocused.focus();
    lastFocused = null;
  }

  function openModal(data, opener) {
    ensureModal();
    const overlay = document.getElementById("medalsModalOverlay");
    const body = document.getElementById("medalsBody");
    body.innerHTML = "";
    const order = ["Ouro", "Prata", "Bronze"];
    order.forEach(k => {
      const col = document.createElement("div");
      col.className = "medals-column";
      const h4 = document.createElement("h4");
      const chip = document.createElement("span");
      chip.className = "medal-chip " + (k === "Ouro" ? "chip-gold" : k === "Prata" ? "chip-silver" : "chip-bronze");
      chip.textContent = k.charAt(0);
      h4.appendChild(chip);
      const title = document.createElement("span");
      title.textContent = " " + k;
      h4.appendChild(title);
      col.appendChild(h4);
      const ul = document.createElement("ul");
      const items = Array.isArray(data[k]) ? data[k] : [];
      if (!items.length) {
        const li = document.createElement("li");
        li.textContent = "‚Äî";
        ul.appendChild(li);
      } else {
        items.forEach(it => {
          const li = document.createElement("li");
          li.textContent = it;
          ul.appendChild(li);
        });
      }
      col.appendChild(ul);
      body.appendChild(col);
    });
    overlay.classList.add("open");
    overlay.style.display = "flex";
    trapFocus(document.getElementById("medalsModal"));
    const closeBtn = document.getElementById("medalsCloseBtn");
    closeBtn.focus();
    overlay.dataset.openerId = opener ? opener.id || "" : "";
  }

  function closeModal() {
    const overlay = document.getElementById("medalsModalOverlay");
    if (!overlay) return;
    overlay.classList.remove("open");
    overlay.style.display = "none";
    releaseFocusTrap();
    const openerId = overlay.dataset.openerId;
    if (openerId) {
      const btn = document.getElementById(openerId);
      if (btn && typeof btn.focus === "function") btn.focus();
    }
    overlay.dataset.openerId = "";
  }

  window.renderResearchGrid = renderResearchGrid;
})();

renderResearchGrid("#researchGrid", researchData);
renderPortfolio(".ContainerPortfolio", projectsData);
renderSkills("#ContainerGeral", skillsData);
